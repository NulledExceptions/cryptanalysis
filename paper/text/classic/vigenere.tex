\subsection{Шифр Виженера}

Шифр Виженера --- метод полиалфавитного 
шифрования буквенного текста с использованием ключевого слова.

Этот метод является простой формой многоалфавитной замены. Шифр 
Виженера изобретался многократно. Впервые этот метод описал
Giovan Battista Bellaso) в 1553 году, однако в XIX веке 
получил имя Блеза Виженера, французского дипломата. Метод прост 
для понимания и реализации, он является недоступным для простых 
методов криптоанализа.

Первое точное документированное описание многоалфавитного шифра 
было сформулированно Леоном Баттиста Альберти в 1467 году, для 
переключения между алфавитами использовался металлический шифровальный 
диск. Система Альберти переключает алфавиты после нескольких 
зашифрованных слов. Позднее, в 1518 году, Иоганн Трисемус в своей 
работе «Полиграфия» изобрел tabula recta — центральный компонент 
шифра Виженера.

Блез Виженер представил свое описание простого, но стойкого шифра 
перед комиссией Генриха III во Франции в 1586 году, и позднее 
изобретение шифра было присвоено именно ему. Давид Кан в своей 
книге «Взломщики кодов» отозвался об этом осуждающе, написав, 
что история «проигнорировала важный факт и назвала шифр именем 
Виженера, несмотря на то, что он ничего не сделал для его создания».

Шифр Виженера имел репутацию исключительно стойкого к «ручному»
взлому. Известный писатель и математик Чарльз Лютвидж Доджсон 
(Льюис Кэрролл) назвал шифр Виженера невзламываемым в своей статье 
«Алфавитный шифр», опубликованной в 
детском журнале в 1868 году. В 1917 году Scientific American 
также отозвался о шифре Виженера, как о неподдающемся взлому. 
Это представление было опровергнуто после того, как Касиски полностью 
взломал шифр в XIX веке, хотя известны случаи взлома этого шифра 
некоторыми опытными криптоаналитиками еще в XVI веке.

\subsubsection{Описание шифра Виженера}

В шифре Цезаря каждая буква алфавита сдвигается на несколько 
строк; например в шифре Цезаря при сдвиге +3, A стало бы D, B 
стало бы E и так далее. Шифр Виженера состоит из последовательности 
нескольких шифров Цезаря с различными значениями сдвига. Для 
зашифровывания может использоваться таблица алфавитов, называемая 
tabula recta или квадрат (таблица) Виженера. Применительно к 
латинскому алфавиту таблица Виженера составляется из строк по 
26 символов, причём каждая следующая строка сдвигается на несколько 
позиций. Таким образом, в таблице получается 26 различных шифров 
Цезаря. На разных этапах кодировки шифр Виженера использует различные 
алфавиты из этой таблицы. На каждом этапе шифрования используются 
различные алфавиты, выбираемые в зависимости от символа ключевого 
слова. Например, предположим, что исходный текст имеет вид:

\begin{verbatim}
                               ATTACKATDAWN
\end{verbatim}

Человек, посылающий сообщение, записывает ключевое слово («LEMON») 
циклически до тех пор, пока его длина не будет соответствовать 
длине исходного текста:

\begin{verbatim}
                               LEMONLEMONLE
\end{verbatim}

Первый символ исходного текста A зашифрован последовательностью 
L, которая является первым символом ключа. Первый символ L шифрованного 
текста находится на пересечении строки L и столбца A в таблице 
Виженера. Точно так же для второго символа исходного текста используется 
второй символ ключа; то есть второй символ шифрованного текста 
X получается на пересечении строки E и столбца T. Остальная часть 
исходного текста шифруется подобным способом.

\begin{verbatim}
                               ATTACKATDAWN
                               LEMONLEMONLE
                               LXFOPVEFRNHR
\end{verbatim}

Расшифровывание производится следующим образом: находим в таблице 
Виженера строку, соответствующую первому символу ключевого слова;
в данной строке находим первый символ зашифрованного текста.
Столбец, в котором находится данный символ, соответствует первому 
символу исходного текста. Следующие символы зашифрованного текста 
расшифровываются подобным образом.

Если буквы A-Z соответствуют числам 0-25, то шифрование и 
расшифрование Виженера 
можно записать в виде формул:

    $$C_i \equiv (P_i + K_i) \mod\ 26$$
    $$P_i \equiv (C_i - K_i + 26) \mod\ 26$$

\subsubsection{Криптоанализ, работа с полиалфавитными шифрами}

Шифр Виженера «размывает» характеристики частот появления символов 
в тексте, но некоторые особенности появления символов в тексте 
остаются. Главный недостаток шифра Виженера состоит в том, что 
его ключ повторяется. Поэтому простой криптоанализ шифра может 
быть построен в два этапа:

Поиск длины ключа. Можно анализировать распределение частот в 
зашифрованном тексте с различным прореживанием. То есть брать 
текст, включающий каждую 2-ю букву зашифрованного текста, потом 
каждую 3-ю и т. д. Как только распределение частот букв будет 
сильно отличаться от равномерного (например, по энтропии), то 
можно говорить о найденной длине ключа.

\paragraph{Метод Касиски}

В 1863 году Фридрих Касиски был первым, кто опубликовал успешный 
алгоритм атаки на шифр Виженера, хотя Чарльз Беббидж разработал 
этот алгоритм уже в 1854 году. В то время когда Беббидж занимался 
взломом шифра Виженера, John Hall Brock Thwaites представил новый 
шифр в «Journal of the Society of the Arts»; когда Беббидж показал,
что шифр Thwaites’а является лишь частным случаем шифра Виженера,
Thwaites предложил ему его взломать. Беббидж расшифровал текст,
который оказался поэмой «The Vision of Sin» Альфреда Теннисона,
зашифрованной ключевым словом Emily — именем жены поэта.

Тест Касиски опирается на то, что некоторые слова, такие как 
«the» могут быть зашифрованы одинаковыми символами, что приводит 
к повторению групп символов в зашифрованном тексте. Например: 
сообщение, зашифрованное ключом ABCDEF , не всегда одинаково 
зашифрует слово «crypto».

Зашифрованный текст в данном случае не будет повторять последовательности 
символов, которые соответствуют повторным последовательностям 
исходного текста. В данном шифрованном тексте есть несколько 
повторяющихся сегментов, которые позволяют криптоаналитику найти 
длину ключа.

Более длинные сообщения делают тест более точным, так как они 
включают в себя больше повторяющихся сегментов зашифрованного 
текста. В данном шифрованном тексте есть несколько повторяющихся 
сегментов, которые позволяют криптоаналитику найти длину ключа.

Расстояние между повторяющимися DYDUXRMH равно 18, это позволяет 
сделать вывод, что длина ключа равна одному из значений: 
18, 9, 6, 3 или 2. Расстояние между повторяющимися NQD равно 20. Из 
этого следует, что длина ключа равна 20, 10, 5, 4 
или 2. Сравнивая возможные длины ключей, можно сделать вывод, 
что длина ключа (почти наверняка) равна 2.

\paragraph{Тест Фридмана}

(иногда называемый каппа-тест) был изобретен Вильямом 
Фридманом в 1920 году. Фридман использовал индекс совпадения, 
который измеряет частоты повторения символов, чтобы взломать 
шифр. Зная вероятность $\kappa_p$ того, что два случайно выбранных 
символа текста совпадают (примерно 0,067 для англ. языка) и вероятность 
совпадения двух случайно выбранных символов алфавита $\kappa_r$ 
(примерно 1 / 26 = 0,0385 для англ. языка), можно оценить длину 
ключа как:

    $${\kappa_p-\kappa_r}\over{\kappa_o-\kappa_r}$$

Из наблюдения за частотой совпадения следует:

    $$\kappa_o=\frac{\sum_{i=1}^{c}n_i(n_i -1)}{N(N-1)}$$

Где $С$ — размер алфавита (26 символов для англ. языка), $N$ — длина 
текста, и $n_1$ до $n_c$ — наблюдаемые частоты повторения символов 
зашифрованного текста. Однако, это только приблизительное значение,
точность которого увеличивается при большем размере текста. 
На практике это было бы необходимо для перебора различных ключей 
приближаясь к исходному.

\paragraph{Частотный анализ}

Как только длина ключа становится известной, зашифрованный текст 
можно записать во множество столбцов, каждый из которых соответствует 
одному символу ключа. Каждый столбец состоит из исходного текста
, который зашифрован шифром Цезаря; ключ к шифру Цезаря является 
всего-навсего одним символом ключа для шифра Виженера, который 
используется в этом столбце. Используя методы, подобные методам 
взлома шифра Цезаря, можно расшифровать зашифрованный текст. 
Усовершенствование теста Касиски, известное как метод Кирхгофа
, заключается в сравнении частоты появления символов в столбцах 
с частотой появления символов в исходном тексте для нахождения 
ключевого символа для этого столбца. Когда все символы ключа 
известны, криптоаналитик может легко расшифровать шифрованный 
текст, получив исходный текст. Метод Кирхгофа не применим, когда 
таблица Виженера скремблирована, вместо использования обычной 
алфавитной последовательности, хотя тест Касиски и тесты совпадения 
всё ещё могут использоваться для определения длины ключа для 
этого случая.
