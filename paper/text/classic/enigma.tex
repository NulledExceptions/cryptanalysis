\subsection{Энигма}
Энигма — портативная шифровальная машина, использовавшаяся для шифрования 
и дешифрования секретных сообщений. Более точно, Энигма — целое семейство 
электромеханических роторных машин, применявшихся с 20-х годов XX 
века.

Энигма использовалась в коммерческих целях, а также в военных и государственных 
службах во многих странах мира, но наибольшее распространение получила 
в нацистской Германии во время Второй мировой войны — именно Энигма 
вермахта (Wehrmacht Enigma) — германская военная модель — чаще всего 
является предметом дискуссий.

\subsubsection{Описание}
Как и другие роторные машины, Энигма состояла из комбинации механических 
и электрических подсистем. Механическая часть включала в себя клавиатуру
, набор вращающихся дисков — роторов, — которые были расположены вдоль 
вала и прилегали к нему, и ступенчатого механизма, двигающего один 
или несколько роторов при каждом нажатии на клавишу.

Конкретный механизм работы мог быть разным, но общий принцип был таков: 
при каждом нажатии на клавишу самый правый ротор сдвигается на одну 
позицию, а при определённых условиях сдвигаются и другие роторы. Движение 
роторов приводит к различным криптографическим преобразованиям при 
каждом следующем нажатии на клавишу на клавиатуре.

Механические части двигались, замыкая контакты и образуя меняющийся 
электрический контур (то есть, фактически, сам процесс шифрования 
букв реализовывался электрически). При нажатии на клавишу клавиатуры 
контур замыкался, ток проходил через различные цепи и в результате 
включал одну из набора лампочек, и отображавшую искомую букву кода.
(Например: при шифровке сообщения, начинающегося с ANX…, оператор 
вначале нажимал на клавишу A — загоралась лампочка Z — то есть Z и 
становилась первой буквой криптограммы. Далее оператор нажимал N и 
продолжал шифрование таким же образом далее).

Таким образом, постоянное изменение электрической цепи, через которую 
шёл ток, вследствие вращения роторов позволяло реализовать многоалфавитный 
шифр подстановки, что давало высокую, для того времени, устойчивость шифра.

Роторы — сердце Энигмы. Каждый ротор представлял собой диск примерно 
10 см в диаметре, сделанный из эбонита или бакелита, с пружинными 
штыревыми контактами на одной стороне ротора, расположенными по окружности
. На другой стороне находилось соответствующее количество плоских 
электрических контактов. Штыревые и плоские контакты соответствовали 
буквам в алфавите (обычно это были 26 букв от A до Z). При соприкосновении 
контакты соседних роторов замыкали электрическую цепь. Внутри ротора 
каждый штыревой контакт был соединён с одним из плоских. Порядок соединения 
мог быть различным.

Сам по себе ротор производил очень простой тип шифрования: элементарный 
шифр замены. Например, контакт, отвечающий за букву E, мог быть соединён 
с контактом буквы T на другой стороне ротора. Но при использовании 
нескольких роторов в связке (обычно трёх или четырёх) за счёт их постоянного 
движения получается более надёжный шифр.

Преобразование Энигмы для каждой буквы может быть определено математически 
как результат перестановок. Рассмотрим трёхроторную армейскую модель
. Положим, что P обозначает коммутационную панель, U обозначает отражатель
, а L, M, R обозначают действия левых, средних и правых роторов соответственно
. Тогда шифрование E может быть выражено как:

    $$E = PRMLUL^{-1}M^{-1}R^{-1}P^{-1}$$

После каждого нажатия клавиш ротор движется, изменяя трансформацию
. Например, если правый ротор R проворачивается на i позиций, происходит 
трансформация $\rho^iR\rho^{-i}$, где $\rho$ — циклическая перестановка
, проходящая от A к B, от B к C, и так далее. Таким же образом, средний 
и левый ротор могут быть обозначены как j и k вращений M и L. Функция 
шифрования в этом случае может быть отображена следующим образом:

    $$E = P(\rho^iR\rho^{-i})(\rho^{j}M\rho^{-j})(\rho^{k}L\rho^{-k})U(\rho^kL^{-1}\rho^{-k})(\rho^{j}M^{-1}\rho^{-j})(\rho^{i}R^{-1}\rho^{-i})P^{-1}$$

\subsubsection{Криптоанализ, подбор ключа сложной структуры}
Попытки «взломать» Энигму не предавались гласности до конца 1970-х.
После этого интерес к Энигме значительно возрос, и множество шифровальных 
машин представлено к публичному обозрению в музеях США и Европы.

Как было указано, Энигма это цлое семейство машин а не один 
алгоритм. Мы изучим одну из последних модификаций. Она появилась
летом 1939 года когда немцы усложнили процедуру шифрования, добавив 
в набор два ротора к имеющимся трем, увеличив количество возможных комбинаций 
установок роторов с $3! = 6$ до 
$A_5^3 = \frac{{5!}}{{\left( {5 - 3} \right)!}} = 60$. 
После изучения польских материалов Алан Тьюринг 
приш`л к выводу, что использовать подход с полным перебором сообщений 
уже не получится. Во-первых, это потребует создания более 30 
экземпляров «Бомбы», что во много раз превышало годовой бюджет 
«Station X». Во-вторых, Германия должна была в скором времени 
догадаться и исправить конструктивный недостаток, на котором 
основывался польский метод. Поэтому он разработал собственный 
метод, основанный на переборе последовательностей символов исходного 
текста. Однако, появившаяся в «Энигме» коммутационная доска, 
простейший с точки зрения схемотехники элемент, добавила проблем 
исследователям. С ней «боролся» Гордон Велчман, который изобр
`л метод «диагональной доски». На основе своих методов, в августе 
1940 года, с помощью компании «British Tabulating Machines
и ее конструктора Гарольда Кина была 
построена первая британская криптоаналитическая машина, которая 
была названа Bombe, в знак уважения к польским криптографам. 
Впоследствии за время войны было выпущено 210 устройств, позволивших 
расшифровывать до двух-трех тысяч сообщений в день.

C современной точки зрения шифр «Энигмы» был не очень надежным,
но только сочетание этого фактора с наличием множества перехваченных 
сообщений, кодовых книг, донесений разведки, результатов усилий 
военных и даже террористических атак позволило «вскрыть» шифр.

В 2007 году запущен проект распределённых вычислений Enigma@Home, 
целью которого является взлом трех зашифрованных сообщений Энигмы, 
перехваченных в северной Атлантике в 1942 году.
